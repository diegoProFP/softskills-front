<div class="modal">
    <div class="modal-content">
        <button class="close-button" (click)="closeModal()">×</button>

      <mat-accordion>
        <mat-expansion-panel [expanded]="currentStep === 1">
            <mat-expansion-panel-header>
              <mat-panel-title>
                Curso {{cursoSeleccionado?.nombreVisible}}
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div *ngIf="cursoSeleccionado">
              <p>Curso seleccionado: {{ cursoSeleccionado.nombreVisible }}</p>
              <!-- Muestra más detalles del curso si es necesario -->
            </div>
            <div *ngIf="!cursoSeleccionado">
              <p>Seleccione un curso:</p>
              <ul>
                <li *ngFor="let curso of cursos$ | async">
                  {{ curso.nombreVisible }}
                  <!-- Añadir lógica para seleccionar un curso -->
                </li>
              </ul>
            </div>
            <mat-action-row>
              <button mat-button (click)="previousStep()" [disabled]="currentStep === 1">Anterior</button>
              <button mat-button (click)="nextStep()">Siguiente</button>
            </mat-action-row>
          </mat-expansion-panel>
  
          <mat-expansion-panel (opened)="onPanelOpened(2)">
            <mat-expansion-panel-header>
              <mat-panel-title>
                Alumno: {{alumnoSeleccionado?.nombre}}
              </mat-panel-title>
            </mat-expansion-panel-header>
            
          
            <div class="custom-chips">
             Por nombre: <button *ngFor="let grupo of letrasGrupos"
                      [class.active]="letraSeleccionada === grupo.rango"
                      (click)="filtrarAlumnos(grupo.rango)">
                {{ grupo.letra }}
              </button>
            </div>
          
            <!-- Lista de alumnos filtrados -->
            <div *ngIf="letraSeleccionada && alumnosFiltrados.length > 0" class="alumnos-grid">
              <mat-card 
                *ngFor="let alumno of alumnosFiltrados" 
                class="alumno-card"
                [class.selected]="alumnoSeleccionado?.id === alumno.id"
                (click)="seleccionarAlumno(alumno)">
                <mat-card-header>
                  <mat-card-title>{{ alumno.nombre }}</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                  {{ alumno.apellidos }}
                </mat-card-content>
              </mat-card>
            </div>
          
            <div *ngIf="letraSeleccionada && alumnosFiltrados.length === 0">
              No se encontraron alumnos para el rango seleccionado.
            </div>
          
            <mat-action-row>
              <button mat-button (click)="previousStep()">Anterior</button>
              <button mat-button (click)="nextStep()" [disabled]="!alumnoSeleccionado">Siguiente</button>
            </mat-action-row>
          </mat-expansion-panel>
  
          <mat-expansion-panel (opened)="onPanelOpened(3)" [expanded]="currentStep === 3">
            <mat-expansion-panel-header>
              <mat-panel-title>
                Soft Skill
                <span *ngIf="softSkillSeleccionada"> : {{ softSkillSeleccionada.nombre }}</span>
              </mat-panel-title>
            </mat-expansion-panel-header>
            
            <div *ngIf="softSkills.length > 0" class="soft-skills-container">
              <div class="custom-chips">
                <button 
                  *ngFor="let skill of softSkills" 
                  [class.active]="softSkillSeleccionada?.id === skill.id"
                  (click)="seleccionarSoftSkill(skill)"
                  class="skill-button">
                  {{ skill.nombre }}
                </button>
              </div>
            </div>
          
            <div *ngIf="softSkills.length === 0">
              No hay soft skills disponibles para este curso.
            </div>
          
            <mat-action-row>
              <button mat-button (click)="previousStep()">Anterior</button>
              <button 
                mat-button 
                color="primary" 
                (click)="nextStep()" 
                [disabled]="!softSkillSeleccionada">
                Siguiente
              </button>
            </mat-action-row>
          </mat-expansion-panel>
  
          <mat-expansion-panel (opened)="onPanelOpened(4)" [expanded]="currentStep === 4">
            <mat-expansion-panel-header>
              <mat-panel-title>
                Paso 4: Valoración
                <span *ngIf="valoracionSeleccionada">
                  - Valoración: {{ valoracionSeleccionada === 'positiva' ? 'Positiva' : 'Negativa' }}
                </span>
              </mat-panel-title>
            </mat-expansion-panel-header>
          
            <div *ngIf="softSkillSeleccionada?.tipo === 0">
              <app-valoracion-positiva-negativa 
                (valoracionSeleccionada)="handleValoracionSeleccionada($event)">
              </app-valoracion-positiva-negativa>
            </div>
          
            <div *ngIf="softSkillSeleccionada?.tipo !== 0">
              <!-- Aquí irían los otros tipos de valoración según el tipo -->
              <p>Este tipo de valoración no está implementado aún.</p>
            </div>
          
            <mat-action-row>
              <button mat-button (click)="previousStep()">Anterior</button>
              <button 
                mat-button 
                color="primary" 
                (click)="nextStep()" 
                [disabled]="!valoracionSeleccionada">
                Siguiente
              </button>
            </mat-action-row>
          </mat-expansion-panel>
  
        <mat-expansion-panel  (opened)="onPanelOpened(5)">
          <mat-expansion-panel-header>
            <mat-panel-title>
              Paso 5: Resumen y Confirmar
            </mat-panel-title>
          </mat-expansion-panel-header>
          <!-- Contenido del paso 5 -->
          <p>Esta es la selección del resumen y confirmar</p>
          <mat-action-row>
            <button mat-button (click)="previousStep()">Anterior</button>
            <button mat-button (click)="resetWizard()">Reiniciar</button>
          </mat-action-row>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </div>